// ===== Translations =====
const translations = {
  en: {
    "logo-text":"Voice Pulse","nav-voicepulse":"VoicePulse","nav-insightai":"InsightAI","nav-actionsync":"ActionSync","nav-insights":"Our Insights","nav-about":"About Us","nav-signup":"Sign up",
    "hero-title":"Voice Pulse","hero-description":"A continuous listening framework that captures multi-source feedback and turns it into measurable insights across the care journey.",
    "features-title":"Our Key Features",
    "feature1-title":"Patient and Carer Experience Surveys","feature1-description":"An advanced approach to measuring experiences with high accuracy, capable of capturing variations across different stages of the care journey.",
    "feature1-item1":"Dynamic survey design tailored to service type and audience segment","feature1-item2":"Analysis that uncovers deeper experiential gaps rather than surface-level satisfaction","feature1-item3":"Integration of responses with clinical and operational data for deeper insight","feature1-item4":"Comprehensive coverage of pre-, during-, and post-service interactions",
    "feature2-title":"Computer-Assisted Telephone Interviewing (CATI)","feature2-description":"A structured and technology-enabled method for collecting precise insights through guided, data-driven phone interactions.",
    "feature2-item1":"Standardized call scripts adapted to language, context, and service type","feature2-item2":"Smart interview models that capture and convert responses into analyzable data","feature2-item3":"Access to audiences that do not engage with digital or self-administered channels","feature2-item4":"Extraction of both quantitative indicators and qualitative observations during calls",
    "feature3-title":"Experience-Based Co-Design (EBCD) Workshops and Focus Groups","feature3-description":"A participatory framework that brings patients, caregivers, and healthcare staff together to redesign experiences based on real needs—not assumptions.",
    "feature3-item1":"Engaging stakeholders in identifying pain points and opportunities across the care pathway","feature3-item2":"Facilitating interactive sessions to address root causes rather than surface symptoms","feature3-item3":"Co-developing actionable improvements with clinical and operational teams","feature3-item4":"Translating individual experiences into insights that inform policy and service design",
    "feature4-title":"Social Listening and Sentiment Monitoring","feature4-description":"A smart mechanism for capturing what is being said across digital channels and turning unprompted opinions into actionable signals.",
    "feature4-item1":"Monitoring conversations and mentions across social platforms and online communities","feature4-item2":"Sentiment and language analysis to uncover invisible experience gaps","feature4-item3":"Early detection of emerging trends related to satisfaction, concern, or trust","feature4-item4":"Alignment of insights with experience dashboards to support improvement cycles",
    "quote-title":"Are you hearing everything that's being said — or only what's being said to you?","quote-text":"VoicePulse doesn't wait for feedback to arrive through formal channels. It captures experiences from both silent and explicit signals — from passing emotions and in-the-moment impressions to digital sentiment and contextual interactions — and turns them into insights that can be measured, tracked, and improved.",
    "contact-title":"Ready to Transform Your Business?","contact-subtitle":"Get started today and see the difference our platform can make","contact-info-title":"Contact Information","contact-phone":"Phone","contact-email":"Email","contact-address":"Address",
    "form-name":"Your Name","form-email":"Your Email","form-message":"Your Message","form-submit":"Send Message",
    "footer-description":"Transforming businesses through intelligent customer insights","footer-copyright":"© 2025 Kasaji.AI. All rights reserved."
  },
  ar: {
    "logo-text":"Voice Pulse","nav-voicepulse":"VoicePulse","nav-insightai":"InsightAI","nav-actionsync":"ActionSync","nav-insights":"رؤانا","nav-about":"من نحن","nav-signup":"سجل",
    "hero-title":"Voice Pulse","hero-description":"إطار عمل للاستماع المستمر يلتقط التغذية الراجعة متعددة المصادر ويحولها إلى رؤى قابلة للقياس عبر رحلة الرعاية.",
    "features-title":"ميزاتنا الرئيسية",
    "feature1-title":"استبيانات تجربة المرضى ومقدمي الرعاية","feature1-description":"نهج متقدم لقياس التجارب بدقة عالية، قادر على التقاط التباينات عبر مراحل مختلفة من رحلة الرعاية.",
    "feature1-item1":"تصميم استبيان ديناميكي مخصص لنوع الخدمة والجمهور المستهدف","feature1-item2":"تحليل يكشف فجوات تجريبية أعمق بدلاً من الرضا السطحي","feature1-item3":"دمج الردود مع البيانات السريرية والتشغيلية لرؤى أعمق","feature1-item4":"تغطية شاملة للتفاعلات قبل وأثناء وبعد الخدمة",
    "feature2-title":"المقابلة الهاتفية بمساعدة الكمبيوتر (CATI)","feature2-description":"طريقة منظمة وممكنة بالتكنولوجيا لجمع رؤى دقيقة من خلال تفاعلات هاتفية موجهة تعتمد على البيانات.",
    "feature2-item1":"نصوص مكالمات معيارية مكيفة للغة والسياق ونوع الخدمة","feature2-item2":"نماذج مقابلة ذكية تلتقط وتحول الردود إلى بيانات قابلة للتحليل","feature2-item3":"الوصول إلى الجماهير التي لا تتفاعل مع القنوات الرقمية أو ذاتية الإدارة","feature2-item4":"استخراج كل من المؤشرات الكمية والملاحظات النوعية أثناء المكالمات",
    "feature3-title":"ورش عمل مجموعات التركيز القائمة على التجربة (EBCD)","feature3-description":"إطار مشاركة يجمع المرضى ومقدمي الرعاية والموظفين الصحيين معًا لإعادة تصميم التجارب بناءً على الاحتياجات الحقيقية - وليس الافتراضات.",
    "feature3-item1":"إشراك أصحاب المصلحة في تحديد نقاط الألم والفرص عبر مسار الرعاية","feature3-item2":"تسهيل جلسات تفاعلية لمعالجة الأسباب الجذرية بدلاً من الأعراض السطحية","feature3-item3":"تطوير تحسينات قابلة للتنفيذ مع الفرق السريرية والتشغيلية","feature3-item4":"ترجمة التجارب الفردية إلى رؤى ت Inform السياسة وتصميم الخدمات",
    "feature4-title":"الاستماع الاجتماعي ومراقبة المشاعر","feature4-description":"آلية ذكية لالتقاط ما يقال عبر القنوات الرقمية وتحويل الآراء غير المطلوبة إلى إشارات قابلة للتنفيذ.",
    "feature4-item1":"مراقبة المحادثات والإشارات عبر منصات التواصل الاجتماعي والمجتمعات عبر الإنترنت","feature4-item2":"تحليل المشاعر واللغة للكشف عن فجوات التجربة غير المرئية","feature4-item3":"الكشف المبكر عن الاتجاهات الناشئة المتعلقة بالرضا أو القلق أو الثقة","feature4-item4":"مواءمة الرؤى مع لوحات معلومات التجربة لدعم دورات التحسين",
    "quote-title":"هل تسمع كل ما يقال - أم فقط ما يقال لك؟","quote-text":"Voice Pulse لا تنتظر وصول التغذية الراجعة عبر القنوات الرسمية. إنها تلتقط التجارب من كل من الإشارات الصامتة والصريحة - من المشاعر العابرة والانطباعات اللحظية إلى المشاعر الرقمية والتفاعلات السياقية - وتحولها إلى رؤى يمكن قياسها وتتبعها وتحسينها.",
    "contact-title":"هل أنت مستعد لتحويل أعمالك؟","contact-subtitle":"ابدأ اليوم وشاهد الفرق الذي يمكن أن تحدثه منصتنا","contact-info-title":"معلومات الاتصال","contact-phone":"الهاتف","contact-email":"البريد الإلكتروني","contact-address":"العنوان",
    "form-name":"اسمك","form-email":"بريدك الإلكتروني","form-message":"رسالتك","form-submit":"إرسال الرسالة",
    "footer-description":"تحويل الشركات من خلال رؤى العملاء الذكية","footer-copyright":"© 2025 Kasaji.AI. جميع الحقوق محفوظة."
  }
};

// Language State
let currentLanguage = localStorage.getItem('language') || 'en';

// ---- Language helpers
function updateLanguage(){
  const body = document.body;
  if (currentLanguage === 'ar'){ body.setAttribute('dir','rtl'); body.setAttribute('lang','ar'); }
  else { body.setAttribute('dir','ltr'); body.setAttribute('lang','en'); }

  document.querySelectorAll('[data-translate]').forEach(el=>{
    const key = el.getAttribute('data-translate');
    const v = translations[currentLanguage][key];
    if (v != null) el.textContent = v;
  });
  document.querySelectorAll('[data-translate-placeholder]').forEach(el=>{
    const key = el.getAttribute('data-translate-placeholder');
    const v = translations[currentLanguage][key];
    if (v != null) el.placeholder = v;
  });
}
function toggleLanguage(){
  currentLanguage = currentLanguage === 'en' ? 'ar' : 'en';
  localStorage.setItem('language', currentLanguage);
  updateLanguage();
}
window.toggleLanguage = toggleLanguage; // لو عندك زر يستدعيها

// ---- Init after DOM ready
document.addEventListener('DOMContentLoaded', function(){
  updateLanguage();

  // Loader (optional)
  const loader = document.getElementById('loader');
  if (loader){
    window.addEventListener('load', ()=>{
      loader.style.opacity='0';
      setTimeout(()=> loader.style.display='none', 500);
    });
  }

  // Scroll animations
  if ('IntersectionObserver' in window){
    const animateElements = document.querySelectorAll('.section-title, .feature-card, .quote-section, .contact-container, footer');
    const elementObserver = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{ if(entry.isIntersecting) entry.target.classList.add('animate'); });
    }, { threshold: .1 });
    animateElements.forEach(el=>elementObserver.observe(el));
  }

  // Mobile menu (with guards)
  const menuToggle = document.querySelector('.menu-toggle');
  const navLinks = document.querySelector('.nav-links');
  if (menuToggle && navLinks){
    menuToggle.addEventListener('click', ()=>{
      const open = getComputedStyle(navLinks).display !== 'none';
      if (open){ navLinks.style.display = 'none'; }
      else{
        navLinks.style.display = 'flex';
        navLinks.style.position = 'absolute';
        navLinks.style.top = '70px'; navLinks.style.left = '0'; navLinks.style.right = '0';
        navLinks.style.flexDirection = 'column';
        navLinks.style.backgroundColor = 'white';
        navLinks.style.padding = '20px';
        navLinks.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
        navLinks.style.zIndex = '1001';
      }
    });
  }

  // Smooth scrolling
  document.querySelectorAll('a[href^="#"]').forEach(anchor=>{
    anchor.addEventListener('click', (e)=>{
      const target = document.querySelector(anchor.getAttribute('href'));
      if (!target) return;
      e.preventDefault();
      const navbar = document.querySelector('.navbar');
      const h = navbar ? navbar.offsetHeight : 0;
      window.scrollTo({ top: target.offsetTop - h, behavior: 'smooth' });
    });
  });

  // Navbar shadow
  const navbar = document.querySelector('.navbar');
  window.addEventListener('scroll', ()=>{
    if (!navbar) return;
    navbar.style.boxShadow = window.scrollY > 10 ? '0px 4px 12px rgba(0,0,0,0.1)' : '0px 1px 2px rgba(0,0,0,0.05)';
  });

  // ===== Contact Form (LIVE to /send.php) =====
  const form = document.getElementById('contactForm');
  if (form){
    // ثبّت المسار المطلق للجذر (عدّل لو موقعك تحت مسار فرعي)
    form.setAttribute('action','/send.php');

    // honeypot لو ناقص
    if (!form.querySelector('input[name="company"]')){
      const hp = document.createElement('input');
      hp.type='text'; hp.name='company'; hp.style.display='none'; hp.tabIndex=-1; hp.autocomplete='off';
      form.appendChild(hp);
    }

    form.addEventListener('submit', async function(e){
      e.preventDefault();
      const btn = form.querySelector('.submit-btn');
      const originalText = btn ? btn.textContent : '';

      if (btn){
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ' + (currentLanguage === 'ar' ? 'جارٍ الإرسال...' : 'Sending...');
        btn.disabled = true;
      }

      try{
        const res = await fetch(form.action, { method:'POST', body:new FormData(form) });
        const txt = (await res.text()).trim();
        if (res.ok && txt === 'OK'){
          form.reset(); // بدون رسائل شكر
        } else {
          console.warn('Send failed:', res.status, txt);
        }
      } catch(err){
        console.error('Network error:', err);
      } finally {
        if (btn){ btn.textContent = originalText; btn.disabled = false; }
      }
    });
  }
});